<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page</title>
    <link rel="stylesheet" href="/homepage.css">
    <link rel="stylesheet" href="/trekking.css">
    <script src="https://kit.fontawesome.com/43728a2927.js" crossorigin="anonymous"></script>

</head>

<body>
    <div class="main-container">

        <div class="navbar-container">
            <nav>
                <h1>Dr.Dipak Kumar Kole</h1>
                <div class="routes">
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/publications">Publications</a></li>
                        <li><a href="/activities">Activities</a></li>
                        <li><a href="/awards">Achievements</a></li>
                        <li><a href="/student">Scholar</a></li>
                        <li><a href="/news">News</a></li>
                        <li><a href="/trekking">Trekking & Riding</a></li>
                        <li><a href="/dashboard">Dashboard</a></li>
                        <li style="border-bottom: 2px solid #2962ff;"><a href="/myStudentFamily">My Student Family</a></li>
                        <li><a href="/administration"> Administration</a></li>
                    </ul>
                </div>
                <div class="hamburger">
                    <div class="line"></div>
                    <div class="line"></div>
                    <div class="line"></div>
                </div>
            </nav>
        </div>

        <h1 id="Trekking">My Student Family</h1>
        <hr>
        <a href="https://forms.gle/RYCfvzKFbHSw2EZu9"><button
                style="background-color: rgb(179, 179, 179); color: black; border-radius: 5px; border: none; padding: 5px; margin: 10px; font-size: 1.1rem;">Google
                Form to Add
                Student</button></a>
        <button onclick="myFunction()"
            style="background-color: rgb(179, 179, 179); color: black; border-radius: 5px; border: none; padding: 5px; margin: 10px; font-size: 1.1rem;">Copy
            Form Link</button>
        <section class="main-section">
            <%let i=-1;%>
                <%for(student of updatedData){ i++;%>
                    <%if(student.view==true){%>
                        <a href="/myStudentFamily/<%=student._id%>/show" style="text-decoration: none;color: black;">
                            <div class="card" style="background-color: rgb(209, 255, 140);">
                                <img src="https://drive.google.com/thumbnail?id=<%=student.photo%>" class="card-img-top"
                                    alt="...">
                                <div class="card-body">
                                    <p><b>Name</b>: <%=student.name%>
                                    </p>
                                    <p><b>Organization </b>:<%=student.org%>
                                    </p>
                                    <p><b>Designation </b>:<%=student.position%>
                                    </p>
                                    <p><b>Work Area </b>:<%=student.area%>
                                    </p>
                                    <p><b>Message </b>:<%=student.message%>
                                    </p>
                                </div>
                                <div class="buttons" style="display: flex;">
                                    <a href="/myStudentFamily/<%=student._id%>/show"
                                        style="text-decoration: none;color: black;"><button
                                            style="background-color: rgb(179, 179, 179); color: black; border-radius: 5px; border: none; padding: 5px; margin: 10px; font-size: 1.1rem;">Details</button></a>
                                    <a href="/myStudentFamily/<%=student._id%>/edit"><button
                                            style="background-color: black;color: white; border-radius: 5px; border: none; padding: 5px; margin: 10px; font-size: 1rem;">Edit</button></a>
                                    <form method="POST" action="/myStudentFamily/<%=student._id%>?_method=DELETE">
                                        <button
                                            style="background-color: red;color: white; border-radius: 5px; border: none; padding: 5px; margin: 10px; font-size: 1rem;">Delete</button>
                                    </form>
                                    <button class="approve-btn" data-id="<%= student._id %>"
                                        data-view="<%= student.view %>" data-index="<%=i%>" style="background-color:rgb(34,
                                        255, 0);color: white; border-radius: 5px; border: none; padding: 5px; margin:
                                        10px; font-size: 1rem;">Approved</button>
                                </div>
                            </div>
                        </a>
                        <%}else{%>
                            <a href="/myStudentFamily/<%=student._id%>/show"
                                style="text-decoration: none;color: black;">
                                <div class="card" style="background-color: rgb(255, 161, 161);">
                                    <img src="https://drive.google.com/thumbnail?id=<%=student.photo%>"
                                        class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <p><b>Name</b>: <%=student.name%>
                                        </p>
                                        <p><b>Organization </b>:<%=student.org%>
                                        </p>
                                        <p><b>Designation </b>:<%=student.position%>
                                        </p>
                                        <p><b>Work Area </b>:<%=student.area%>
                                        </p>
                                        <p><b>Message </b>:<%=student.message%>
                                        </p>
                                    </div>
                                    <div class="buttons" style="display: flex;">
                                        <a href="/myStudentFamily/<%=student._id%>/show"
                                            style="text-decoration: none;color: black;"><button
                                                style="background-color: rgb(179, 179, 179); color: black; border-radius: 5px; border: none; padding: 5px; margin: 10px; font-size: 1.1rem;">Details</button></a>
                                        <a href="/myStudentFamily/<%=student._id%>/edit"><button
                                                style="background-color: black;color: white; border-radius: 5px; border: none; padding: 5px; margin: 10px; font-size: 1rem;">Edit</button></a>
                                        <form method="POST" action="/myStudentFamily/<%=student._id%>?_method=DELETE">
                                            <button
                                                style="background-color: red;color: white; border-radius: 5px; border: none; padding: 5px; margin: 10px; font-size: 1rem;">Delete</button>
                                        </form>
                                        <button class="approve-btn" data-id="<%= student._id %>"
                                            data-view="<%= student.view %>" data-index="<%=i%>" style="background-color:
                                            blue;color: white; border-radius: 5px; border: none; padding: 5px; margin:
                                            10px; font-size: 1rem;">Approve</button>
                                    </div>
                                </div>
                            </a>
                            <%}}%>
        </section>

        <footer>
            <h2>Dr. Dipak Kumar Kole</h2>
            <h3><strong style="font-weight: 600;">Email :</strong> dipak.kole@cse.jgec.ac.in, dipak.kole@gmail.com </h3>
            <h3><strong style="font-weight: 600;">Address :</strong> Singur, Hooghly, West Bengal, India.</h3>
            <div class="links">
                <!-- <a href="" style="font-size: 2rem; color: white;"><i class="fi fi-brands-twitter"></i></a>
                <a href="" style="font-size: 2rem; color: white;"><i class="fi fi-brands-linkedin"></i></a>
                <a href="" style="font-size: 2rem; color: white;"><i class="fi fi-brands-github"></i></a> -->
                <a href="<%=googleScholar%>" style="font-size: 2rem; color: white;"><i class="fa-brands fa-google-scholar"></i></a>
                <a href="<%= linkedin %>" style="font-size: 2rem; color: white;"><i
                        class="fi fi-brands-linkedin"></i></a>
                <a href="<%=facebook %>" style="font-size: 2rem; color: white;"><i
                        class="fi fi-brands-facebook"></i></a>
            </div>
            <hr style="width: 100%;">
            <p style="margin: 0.3rem 0;">@ Dr.Dipak Kumar Kole | 2024</p>
        </footer>
    </div>


    <script>
        document.querySelectorAll('.approve-btn').forEach(button => {
            button.addEventListener('click', async () => {
                console.log("Button clicked");
                // const students = JSON.parse('<%-JSON.stringify(data) %>');
                const index = button.dataset.index;
                const id = button.dataset.id;
                console.log("IDD : ", id);
                const view = button.dataset.view === 'true';
                const newView = !view;
                const newMSF = { view: newView };
                try {
                    const response = await fetch(`/myStudentFamily/${id}/toggle`, {
                        method: 'PATCH',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ newMSF })
                    });

                    if (response.ok) {
                        location.reload(); // Reload the page to reflect changes
                    } else {
                        console.error('Failed to toggle view status');
                    }
                } catch (error) {
                    console.error('Error:', error);
                }
            });
        });
    </script>

    <script>
        function myFunction() {
            // Copy the text inside the text field
            navigator.clipboard.writeText('https://forms.gle/RYCfvzKFbHSw2EZu9');

            // Alert the copied text
            alert("Copied to the clipboard");
        }
    </script>

    <script>
        let hamburger = document.querySelector('.hamburger');
        hamburger.addEventListener('click', () => {
            let routes = document.querySelector('.routes');
            routes.classList.toggle('active');
        })
    </script>
</body>

</html>